<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Francisco Ascue Orosco">
<title>Genomics web - Fundamentos de NGS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modulo8.html" rel="next">
<link href="./modulo6.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modulo7.html">Módulo 7</a></li><li class="breadcrumb-item"><a href="./modulo7.html">Fundamentos de NGS</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Genomics web</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/FranciscoAscue/Rgenomics">
            Código Fuente
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/FranciscoAscue/Rgenomics/issues">
            Dejar consultas
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Instalaciones</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instalación de Paquetes</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Módulo 6</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modulo6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Módulo 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modulo7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Fundamentos de NGS</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Módulo 8</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modulo8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genómica con R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modulo8.1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pipeline de Genómica en R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Módulo 9</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modulo9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consenso y Anotación</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Metagenómica</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metagenomica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción a Metagenomica</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">En esta página</h2>
   
  <ul>
<li>
<a href="#archivos-fastq" id="toc-archivos-fastq" class="nav-link active" data-scroll-target="#archivos-fastq">Archivos FASTQ</a>
  <ul class="collapse">
<li><a href="#representaci%C3%B3n-de-secuencias" id="toc-representación-de-secuencias" class="nav-link" data-scroll-target="#representaci%C3%B3n-de-secuencias">Representación de secuencias</a></li>
  <li><a href="#secuencias-simples-fasta" id="toc-secuencias-simples-fasta" class="nav-link" data-scroll-target="#secuencias-simples-fasta">Secuencias simples: FASTA</a></li>
  <li><a href="#fastq-illumina-reads" id="toc-fastq-illumina-reads" class="nav-link" data-scroll-target="#fastq-illumina-reads">Fastq: Illumina Reads</a></li>
  </ul>
</li>
  <li>
<a href="#an%C3%A1lisis-de-datos-ngs-illumina" id="toc-análisis-de-datos-ngs-illumina" class="nav-link" data-scroll-target="#an%C3%A1lisis-de-datos-ngs-illumina">Análisis de datos NGS illumina</a>
  <ul class="collapse">
<li><a href="#control-de-calidad" id="toc-control-de-calidad" class="nav-link" data-scroll-target="#control-de-calidad">Control de Calidad</a></li>
  <li><a href="#comando-de-fastqc-en-linux" id="toc-comando-de-fastqc-en-linux" class="nav-link" data-scroll-target="#comando-de-fastqc-en-linux">Comando de Fastqc en <strong>Linux</strong></a></li>
  <li><a href="#filtrado-de-reads" id="toc-filtrado-de-reads" class="nav-link" data-scroll-target="#filtrado-de-reads">Filtrado de Reads</a></li>
  <li><a href="#comando-de-trim_galore-en-linux" id="toc-comando-de-trim_galore-en-linux" class="nav-link" data-scroll-target="#comando-de-trim_galore-en-linux">Comando de Trim_galore en <strong>Linux</strong></a></li>
  </ul>
</li>
  <li>
<a href="#an%C3%A1lisis-de-conteo-de-k-mers" id="toc-análisis-de-conteo-de-k-mers" class="nav-link" data-scroll-target="#an%C3%A1lisis-de-conteo-de-k-mers">Análisis de conteo de K-mers</a>
  <ul class="collapse">
<li><a href="#esquema-del-tutorial" id="toc-esquema-del-tutorial" class="nav-link" data-scroll-target="#esquema-del-tutorial">Esquema del Tutorial</a></li>
  <li><a href="#contar-la-ocurrencia-de-k-mers-utilizando-jellyfish-2.2.6" id="toc-contar-la-ocurrencia-de-k-mers-utilizando-jellyfish-2.2.6" class="nav-link" data-scroll-target="#contar-la-ocurrencia-de-k-mers-utilizando-jellyfish-2.2.6">1. Contar la ocurrencia de k-mers utilizando Jellyfish 2.2.6</a></li>
  <li><a href="#graficar-los-resultados-utilizando-r" id="toc-graficar-los-resultados-utilizando-r" class="nav-link" data-scroll-target="#graficar-los-resultados-utilizando-r">2. Graficar los resultados utilizando R</a></li>
  <li><a href="#determinar-la-posici%C3%B3n-del-pico-y-el-tama%C3%B1o-del-genoma" id="toc-determinar-la-posición-del-pico-y-el-tamaño-del-genoma" class="nav-link" data-scroll-target="#determinar-la-posici%C3%B3n-del-pico-y-el-tama%C3%B1o-del-genoma">4. Determinar la posición del pico y el tamaño del genoma</a></li>
  </ul>
</li>
  <li>
<a href="#alineamiento" id="toc-alineamiento" class="nav-link" data-scroll-target="#alineamiento">Alineamiento</a>
  <ul class="collapse">
<li><a href="#formato-sambam" id="toc-formato-sambam" class="nav-link" data-scroll-target="#formato-sambam">Formato SAM/BAM</a></li>
  <li><a href="#preparacion-del-index" id="toc-preparacion-del-index" class="nav-link" data-scroll-target="#preparacion-del-index">Preparacion del index</a></li>
  <li><a href="#alineamiento-de-secuencias" id="toc-alineamiento-de-secuencias" class="nav-link" data-scroll-target="#alineamiento-de-secuencias">Alineamiento de secuencias</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Fundamentos de NGS</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Francisco Ascue Orosco </p>
          </div>
  </div>
    
  
    
  </div>
  

</header><p><strong>¿Qué son los datos de secuenciación de nueva generación (NGS)?</strong></p>
<p>Los datos NGS son las secuencias tal como provienen directamente de la plataforma de secuenciación en su forma cruda que a menudo contienen cierto grado de información no deseada:</p>
<ul>
<li><p>Reads de baja calidad que deben ser completamente descartados o parcialmente recortados (trimmed) antes de llevar a cabo análisis bioinformaticos de los datos.</p></li>
<li><p>Secuencias sobrerrepresentadas, como los dímeros de adaptadores.</p></li>
<li><p>La longitud y la distribución de la calidad de los reads pueden variar de una plataforma a otra.</p></li>
<li><p>En Illumina, es común encontrar errores puntuales en la asignación de un nucleótido.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Dado que los datos crudos ocupan mucho espacio en disco y una parte significativa de ellos es información no deseada, por lo general, estos datos crudos no se almacenan en repositorios públicos, como SRA, hasta que han pasado por procesos de filtrado previo (pre-procesamiento).</p>
</div>
</div>
</div>
<section id="archivos-fastq" class="level2"><h2 class="anchored" data-anchor-id="archivos-fastq">Archivos FASTQ</h2>
<section id="representación-de-secuencias" class="level3"><h3 class="anchored" data-anchor-id="representación-de-secuencias">Representación de secuencias</h3>
<p>En informática las secuencias de ADN son una <em>string</em> (cadena) de caracteres.</p>
<ul>
<li><p>Secuencias genómicas {A,C,G,T}+</p></li>
<li><p>Secuencias mRNA {A,C,G,U}+</p></li>
</ul></section><section id="secuencias-simples-fasta" class="level3"><h3 class="anchored" data-anchor-id="secuencias-simples-fasta">Secuencias simples: FASTA</h3>
<p>Línea 1: información de la secuencia</p>
<p>Línea 2: la secuencia.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Ejemplo de Fasta">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de Fasta
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>&gt;gi|365266830|gb|JF701598.1| Pinus densiflora var. densiflora voucher Pf0855 trnS-trnG intergenic spacer, partial sequence; chloroplast</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>GCAGAAAAAATCAGCAGTCATACAGTGCTTGACCTAATTTGATAGCTAGAATACCTGCTGTAAAAGCAAG</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>AAAAAAAGCTATCAAAAATTTAAGCTCTACCATATCTTCATTCCCTCCTCAATGAGTTTGATTAAATGCG</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>TTACATGGATTAGTCCATTTATTTCTCTCCAATATCAAATTTTATTATCTAGATATTGAAGGGTTCTCTA</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>TCTATTTTATTATTATTGTAACGCTATCAGTTGCTCAAGGCCATAGGTTCCTGATCGAAACTACACCAAT</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>GGGTAGGAGTCCGAAGAAGACAAAATAGAAGAAAAGTGATTGATCCCGACAACATTTTATTCATACATTC</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>AGTCGATGGAGGGTGAAAGAAAACCAAATGGATCTAGAAGTTATTGCGCAGCTCACTGTTCTGACTCTGA</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>TGGTTGTATCGGGCCCTTTAGTTATTGTTTTATCAGCAATTCGCAAAGGTAATCTATAATTACAATGAGC</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>CATCTCCGGAGATGGCTCATTGTAATGATGAAAACGAGGTAATGATTGATATAAACTTTCAATAGAGGTT</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>GATTGATAACTCCTCATCTTCCTATTGGTTGGACAAAAGATCGATCCA</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="fastq-illumina-reads" class="level3"><h3 class="anchored" data-anchor-id="fastq-illumina-reads">Fastq: Illumina Reads</h3>
<p>Secuencia fasta + detalles calidad de la información (la Q es de Quality).</p>
<ul>
<li><p>Línea 1: Encabezado (<em>Header</em>): comienza con @.</p></li>
<li><p>Línea 2: la secuencia.</p></li>
<li><p>Línea 3: Comienza con +. Puede ser sólo el símbolo + o repetir la info del Header.</p></li>
<li><p>Línea 4: Información de la calidad de secuenciación de cada base. Cada letra o símbolo representa a una base de la secuencia codificado en formato <a href="http://ascii.cl/">ASCII</a>.</p></li>
</ul>
<p>La info de calidad se codifica en ASCII porque esto permite en 1 sólo caracter codificar un valor de calidad. Por lo tanto la línea 2 y la 4 tienen el mismo número de caracteres.</p>
<p>Ordenados de menor a mayor estos son los caracteres ASCII usados para representar calidad en FASTQ:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>!"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-caution callout-titled" title="Ojo">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ojo
</div>
</div>
<div class="callout-body-container callout-body">
<p>@ y + están dentro de los caracteres ASCII utilizados para codificar la calidad.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Ejemplos de Fastq">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplos de Fastq
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Ejemplos:</strong></p>
<p>Ejemplo de datos FASTQ recién salidos de Illumina:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>@HWI-ST999:102:D1N6AACXX:1:1101:1235:1936 1:N:0:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ATGTCTCCTGGACCCCTCTGTGCCCAAGCTCCTCATGCATCCTCCTCAGCAACTTGTCCTGTAGCTGAGGCTCACTGACTACCAGCTGCAG</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>1:DAADDDF&lt;B&lt;AGF=FGIEHCCD9DG=1E9?D&gt;CF@HHG??B&lt;GEBGHCG;;CDB8==C@@&gt;&gt;GII@@5?A?@B&gt;CEDCFCC:;?CCCAC</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>@OBIWAN:24:D1KUMACXX:3:1112:9698:62774 1:N:0:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>TAATATGGCTAATGCCCTAATCTTAGTGTGCCCAACCCACTTACTAACAAATAACTAACATTAAGATCGGAAGAGCACACGTCTGAACTCAGTCACTGACC</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>CCCFFFFFHHHHHIJJJJJJJJJJJJIIHHIJJJJJJJJJJJJJJJJJJJJIJJJJJJIJJJJIJJJJJJJHHHHFDFFEDEDDDDDDDDDDDDDDDDDDC</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>¿Quieres saber cuáles son las partes del Header? <a href="https://en.wikipedia.org/wiki/FASTQ_format#Illumina_sequence_identifiers">Clic aquí</a>.</p>
<p>Ejemplo de datos FASTQ del SRA:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>@SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=36</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>GGGTGATGGCCGCTGCCGATGGCGTCAAATCCCACC</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>+SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=36</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>IIIIIIIIIIIIIIIIIIIIIIIIIIIIII9IG9IC</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Los datos FASTQ típicamente están comprimidos en formato <code>gzip</code> (.gz) o <code>tar</code> (.tar.gz o .tgz).</p>
</div>
</div>
</div>
</section></section><section id="análisis-de-datos-ngs-illumina" class="level2"><h2 class="anchored" data-anchor-id="análisis-de-datos-ngs-illumina">Análisis de datos NGS illumina</h2>
<section id="control-de-calidad" class="level3"><h3 class="anchored" data-anchor-id="control-de-calidad">Control de Calidad</h3>
<p>Antes de saltar a filtrar tus datos con filtros de calidad que la terminal ejecute muy obediente, lo mejor es ver algunos gráficos básicos que nos dicen mucho más que una serie de caracteres ASCII. Usaremos para ello <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FASTQC</a> que es un programa que hace una serie de análisis básicos y estándar decalidad.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Parámetros en FastQC">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parámetros en FastQC
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Los análisis de FASTQC son útiles para identificar problemas que pudieron surgir durante el laboratorio o durante la secuenciación.</p>
<p>El análisis de FASTQC consiste en los siguientes campos:</p>
<ul>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/1%20Basic%20Statistics.html">Basic Statistics</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html">Per Base Sequence Quality</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html">Per Sequence Quality Scores</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html">Per Base Sequence Content</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/5%20Per%20Sequence%20GC%20Content.html">Per Sequence GC Content</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html">Per Base N Content</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html">Sequence Length Distribution</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html">Duplicate Sequences</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html">Overrepresented Sequences</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/10%20Adapter%20Content.html">Adapter Content</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/11%20Kmer%20Content.html">Kmer Content</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/12%20Per%20Tile%20Sequence%20Quality.html">Per Tile Sequence Quality</a></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Notas importantes">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notas importantes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>FASTQ automáticamente dice si nuestra muestra “pasó” o “falló” la evaluación. Sin embargo debemos tomar esto dentro del <strong>contexto de lo que esperamos de nuestra librería</strong>, ya que FASTQ espera una distribución diversa y al azar de nucleótidos, lo que puede no cumplirse en algunos protocolos.</li>
</ul>
</div>
</div>
</div>
<p>Vamos a la página de dicho programa a ver ejemplos de:</p>
<ul>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html">Buenos datos Illumina</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html">Malos datos Illumina</a></li>
<li><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/RNA-Seq_fastqc.html">Corrida Illumina contaminada con dímeros de adaptadores (<em>adapter dimers</em>)</a></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Dímeros de adaptadores">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dímeros de adaptadores
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>¿Qué que son los dímeros de adaptadores?</strong></p>
<p>Los adaptadores se ligan al ADN de nuestras muestras en un paso de ligación, sin embargo, también pueden ligarse entre sí y luego pegarse a la <em>flow cell</em>. Resultado: son secuenciados pero no proven datos útiles, simplemente la secuencia de los adaptadores repetida muchas veces. Adelante veremos cómo lidiar con ellos bioinformáticamente, pero se recomienda intentar deshacerse de ellos desde el laboratorio (con pequeños, pequeños imanes como <a href="https://www.beckmancoulter.com/wsrportal/wsrportal.portal;jsessionid=jhp2WT8G5B4zYXhzKCPnWk8J1n3TL1JRGLsDbp130t9VRWtbFrY4!-1744838288!-683502135?_nfpb=true&amp;_windowLabel=UCM_RENDERER&amp;_urlType=render&amp;wlpUCM_RENDERER_path=%2Fwsr%2Fcountry-selector%2Findex.htm&amp;_WRpath=%252Fwsr%252Fresearch-and-discovery%252Fproducts-and-services%252Fnucleic-acid-sample-preparation%252Fagencourt-ampure-xp-pcr-purification%252Findex.htm&amp;intBp=true">Agencourt</a> o símiles de otras marcas).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Importancia de Fastqc">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importancia de Fastqc
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>¿Qué tanto importa el análisis FASTQC?</strong></p>
<p>Mucho, a partir del análisis FASTQC es que decidirás si tu secuenciación fue exitosa y qué parámetros de pre-procesamiento deberás utilizar para deshacerte del ruido y quedarte con <strong>datos limpios</strong>.</p>
<p>Escoger los parámetros adecuados de pre-procesamiento es vital ya que todas las corridas de secuenciación son diferentes. Además entender bien tu FASTQC puede permitirte <strong>rescatar</strong> datos usables incluso dentro de una mala corrida.</p>
</div>
</div>
</div>
</section><section id="comando-de-fastqc-en-linux" class="level3"><h3 class="anchored" data-anchor-id="comando-de-fastqc-en-linux">Comando de Fastqc en <strong>Linux</strong>
</h3>
<p>Recuerda moverte a la ubicacion donde se encuentras los archivos Fastq con el comando <code>cd</code> y la direccion.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> results/quality</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fastqc</span> <span class="at">-t</span> 2 <span class="pp">*</span>fastq.gz <span class="at">-o</span> results/quality/</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-warning callout-titled" title="Aclaración">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aclaración
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Durante el curso veremos que estos comandos pueden aplicarse en R y complementaremos con comandos en Linux.</li>
</ul>
</div>
</div>
</section><section id="filtrado-de-reads" class="level3"><h3 class="anchored" data-anchor-id="filtrado-de-reads">Filtrado de Reads</h3>
<section id="pre-procesamiento" class="level4"><h4 class="anchored" data-anchor-id="pre-procesamiento">Pre-procesamiento</h4>
<p>El pre-procesamiento es esencial para obtener <strong>datos limpios</strong> a partir de datos crudos en el campo de la bioinformática. Se utiliza principalmente en el análisis de datos biológicos y se inicia con archivos <code>.fastq</code> como entrada, generando también archivos <code>.fastq</code> como salida, posiblemente en versiones comprimidas.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Pasos comunes pre-procesamiento">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pasos comunes pre-procesamiento
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Recortar secuencias por calidad (<em>Sequence Quality Trimming</em>):</strong> Elimina las bases de baja calidad, típicamente en las últimas bases (-3’ end) de secuencias. La cantidad de bases a recortar se decide visualmente o con un parámetro de calidad, utilizando herramientas como FASTQC.</p></li>
<li><p><strong>Recortar secuencias (<em>Trimming</em>):</strong> Elimina una cantidad específica de bases que no son relevantes para el análisis, como códigos de barras o sitios de restricción.</p></li>
<li><p><strong>Filtrar secuencias por calidad:</strong> Descarta las secuencias que no cumplen con ciertos estándares de calidad, como un número mínimo de bases con calidad o un promedio de calidad específico.</p></li>
<li><p><strong>Quitar adaptadores:</strong> Busca secuencias de adaptadores y las elimina de las secuencias finales. También es posible limitar las secuencias finales a aquellas con un adaptador específico.</p></li>
<li><p><strong>Filtrar artefactos:</strong> Identifica y elimina primers de PCRs, quimeras y otros artefactos de los datos finales.</p></li>
<li><p><strong>Separar por barcodes “demultiplexear”:</strong> Identifica y separa secuencias que contienen códigos de barras (barcodes) únicos por muestra, permitiendo la distinción de secuencias de diferentes muestras. Esto requiere una lista de barcodes y su ubicación en las secuencias.</p></li>
<li><p><strong>Paired end merging:</strong> En el caso de secuenciación Illumina en ambos lados (pair end), se unen las lecturas si se detecta que coinciden, lo que permite corregir errores de secuenciación utilizando la base de mayor calidad.</p></li>
<li><p><strong>Remover otras secuencias no deseadas:</strong> Busca y elimina secuencias no deseadas, como genoma de <em>E. coli</em>, restos de PhiX o partes del genoma que no son de interés, como cpDNA.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advertencia
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Es importante destacar que la lista de barcodes y nombres de muestras es información crítica en un proyecto de bioinformática y debe manejarse con cuidado.</p>
</div>
</div>
</div>
</section></section><section id="comando-de-trim_galore-en-linux" class="level3"><h3 class="anchored" data-anchor-id="comando-de-trim_galore-en-linux">Comando de Trim_galore en <strong>Linux</strong>
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#trim_galore </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">trim_galore</span> <span class="at">--quality</span> 20 <span class="at">--fastqc</span> <span class="at">--length</span> 250 <span class="at">--output_dir</span> <span class="pp">*</span>.gz</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section><section id="análisis-de-conteo-de-k-mers" class="level2"><h2 class="anchored" data-anchor-id="análisis-de-conteo-de-k-mers">Análisis de conteo de K-mers</h2>
<section id="esquema-del-tutorial" class="level3"><h3 class="anchored" data-anchor-id="esquema-del-tutorial">Esquema del Tutorial</h3>
<ol type="1">
<li>Contar la ocurrencia de k-mers utilizando Jellyfish 2.2.6</li>
<li>Generar un histograma utilizando R</li>
<li>Determinar la región de copia única y el total de k-mers</li>
<li>Determinar la posición del pico y el tamaño del genoma</li>
<li>Comparar la forma del pico con la distribución de Poisson</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Lectura 1: Conteo de K-meros">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lectura 1: Conteo de K-meros
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<section id="tamaño-de-k-mer" class="level3"><h3 class="anchored" data-anchor-id="tamaño-de-k-mer">Tamaño de k-mer</h3>
<p>El tamaño de los k-mers debe ser lo suficientemente grande como para permitir que el k-mer se mapee de manera única en el genoma (un concepto utilizado en el diseño de la longitud de cebadores/oligos para la PCR). K-mers demasiado grandes llevan al uso excesivo de recursos computacionales.</p>
<p>En el primer paso, se calcula la frecuencia de k-mers para determinar la cobertura del genoma lograda durante la secuenciación. Existen herramientas de software como Jellyfish que ayudan a encontrar la frecuencia de k-mers en proyectos de secuenciación. La frecuencia de k-mers sigue una distribución pseudo-normal (en realidad, es una distribución de Poisson) alrededor de la cobertura media en el histograma de recuentos de k-mers.</p>
<p>Una vez que se calculan las frecuencias de k-mers, se traza un histograma para visualizar la distribución y calcular la cobertura media.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://bioinformatics.uconn.edu/wp-content/uploads/sites/15/2017/01/genomesize1-768x323.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Histograma de k-mers</figcaption></figure>
</div>
<p>La primera cima (en la región roja) se debe principalmente a errores de secuenciación raros y aleatorios en las lecturas. Los valores en el gráfico pueden recortarse para eliminar lecturas con errores de secuenciación.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="https://bioinformatics.uconn.edu/wp-content/uploads/sites/15/2017/01/genomesize2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Histograma de k-mers después del recorte</figcaption></figure>
</div>
<p>Con la suposición de que los k-mers se asignan de manera única al genoma, deberían estar presentes solo una vez en una secuencia del genoma. Entonces, su frecuencia reflejará la cobertura del genoma.</p>
<p>Para fines de cálculo, utilizamos la cobertura media, que es de 14 en el gráfico anterior. El área bajo la curva representará el número total de k-mers.</p>
<p>Entonces, la estimación del genoma será:</p>
<pre class="math"><code>N = Total de k-mers / Cobertura = Área bajo la curva / cobertura media (14)</code></pre>
</section><section id="metodología" class="level3"><h3 class="anchored" data-anchor-id="metodología">Metodología</h3>
<p>Este estudio tiene como objetivo estimar el tamaño del genoma de una especie utilizando datos de lecturas cortas de baja cobertura. El propósito principal es validar estimaciones previas obtenidas mediante citometría de flujo o generar una nueva estimación computacional.</p>
<p>La estimación del tamaño del genoma se basa en el análisis de subsecuencias cortas llamadas k-mers, extraídas de los datos de secuenciación de Illumina. La elección de un tamaño de k-mer adecuado es esencial para la precisión de la estimación.</p>
<p>El proceso metodológico incluye las siguientes etapas:</p>
<ol type="1">
<li><p><strong>Control de Calidad de las Lecturas</strong>: Las lecturas de secuenciación se someten a un riguroso control de calidad utilizando la herramienta Sickle, con un umbral mínimo de calidad Phred de 25. Esto asegura la eliminación de lecturas de baja calidad que pueden afectar la precisión de la estimación.</p></li>
<li><p><strong>Cálculo de la Distribución de k-mers</strong>: Se utiliza el programa Jellyfish para calcular la distribución de k-mers a partir de las lecturas de secuenciación. Esta distribución es esencial para la estimación del tamaño del genoma.</p></li>
<li><p><strong>Construcción de un Histograma</strong>: Se construye un histograma utilizando el mismo programa Jellyfish para visualizar la distribución de k-mers. Este histograma proporciona información crucial para estimar el tamaño del genoma.</p></li>
<li><p><strong>Análisis Estadístico con R</strong>: Se utiliza el paquete estadístico R para analizar las distribuciones de k-mers. Inicialmente, se traza el conjunto de datos completo, aunque los primeros puntos de datos pueden tener valores atípicos debido a la baja frecuencia. Una vez determinada la posición del pico en el histograma, se calcula el número total de k-mers en la distribución. Esto permite estimar el tamaño del genoma basándose en la posición del pico. Idealmente, la forma del pico debería seguir una distribución de Poisson. Se exploran diferentes tamaños de k-mer para observar una distribución coherente del tamaño del genoma.</p></li>
</ol>
<p>En resumen, este enfoque de estimación del tamaño del genoma combina el análisis de k-mers con el control de calidad de las lecturas y análisis estadísticos para obtener una estimación precisa. Los conjuntos de datos utilizados en el tutorial están disponibles en el clúster BBC, junto con el script utilizado en el proceso.</p>
</section>
</div>
</div>
</div>
</section><section id="contar-la-ocurrencia-de-k-mers-utilizando-jellyfish-2.2.6" class="level3"><h3 class="anchored" data-anchor-id="contar-la-ocurrencia-de-k-mers-utilizando-jellyfish-2.2.6">1. Contar la ocurrencia de k-mers utilizando Jellyfish 2.2.6</h3>
<section id="descargar-secuencia-de-ejemplo-fastq" class="level4"><h4 class="anchored" data-anchor-id="descargar-secuencia-de-ejemplo-fastq">Descargar secuencia de ejemplo Fastq</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">BASH</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR156/080/SRR15616380/SRR15616380_1.fastq.gz"</span>, <span class="st">"SRR15616380_1.fastq.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR156/080/SRR15616380/SRR15616380_2.fastq.gz"</span>, <span class="st">"SRR15616380_2.fastq.gz"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR156/080/SRR15616380/SRR15616380_1.fastq.gz</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR156/080/SRR15616380/SRR15616380_2.fastq.gz</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="ejecutar-jellyfish-en-linux" class="level4"><h4 class="anchored" data-anchor-id="ejecutar-jellyfish-en-linux">Ejecutar jellyfish en Linux</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jellyfish</span> count <span class="at">-t</span> 8 <span class="at">-C</span> <span class="at">-m</span> 19 <span class="at">-s</span> 1G <span class="at">-o</span> 19mer_out <span class="at">--min-qual-char</span><span class="op">=</span><span class="pp">?</span> SRR15616380_1.fastq</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled" title="Explicación de parámetros">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explicación de parámetros
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Opciones utilizadas en el conteo de k-mers:</p>
<ul>
<li>
<code>-t -treads=unit32</code> Número de hilos a utilizar en la ejecución, por ejemplo, 1,2,3, etc.</li>
<li>
<code>-C -both-strands</code> Contar ambas hebras</li>
<li>
<code>-m -mer-len=unit32</code> Longitud del k-mer</li>
<li>
<code>-s -size=unit32</code> Tamaño del hash/asignación de memoria</li>
<li>
<code>-o -output=string</code> Nombre del archivo de salida</li>
<li>
<code>--min-quality-char</code> Valor de calidad de base. La versión 2.2.3 de Jellyfish utiliza la puntuación “Phred”, donde “?” = 30.</li>
</ul>
</div>
</div>
</div>
<p>Esto creará un archivo de salida llamado <code>19mer_out</code>. Luego, utilizando el archivo <code>19mer_out</code> creado anteriormente, se crearán puntos de datos para un histograma utilizando el siguiente comando:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jellyfish</span> histo <span class="at">-o</span> 19mer_out.histo 19mer_out</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section><section id="graficar-los-resultados-utilizando-r" class="level3"><h3 class="anchored" data-anchor-id="graficar-los-resultados-utilizando-r">2. Graficar los resultados utilizando R</h3>
<p>Para visualizar y graficar los datos, utilizamos R. Con el siguiente comando, cargaremos los datos del archivo 19mer_out.histo.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dataframe19</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"19mer_out.histo"</span><span class="op">)</span> <span class="co"># cargar los datos en dataframe19</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Errores Illumina">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Errores Illumina
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>En general, los k-mers de muy baja frecuencia representan números altos que distorsionarían el eje y. Si observamos los puntos de datos en el archivo de histograma, podemos ver que el primer punto de datos tiene un valor excepcionalmente alto en comparación con el siguiente (segundo) punto de datos. Por lo tanto, eliminamos solo la primera línea y volvemos a trazar utilizando R. A partir de ahora, ignoraremos el primer punto de datos para nuestros cálculos.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modulo7_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="determinar-la-región-de-copia-única-y-el-número-total-de-k-mers" class="level4"><h4 class="anchored" data-anchor-id="determinar-la-región-de-copia-única-y-el-número-total-de-k-mers">3. Determinar la región de copia única y el número total de k-mers</h4>
<p>En el examen inicial, el pico comienza desde el segundo punto de datos en adelante. Por lo tanto, ignoramos el primer punto de datos para determinar la región de copia única.</p>
<p>Ahora, utilizando R, volvemos a trazar el gráfico para determinar la región de copia única. Luego incluimos los <strong>puntos</strong> para mayor claridad en el mismo gráfico.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span> <span class="co"># traza el gráfico de línea</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="op">]</span><span class="op">)</span> <span class="co"># traza los puntos de datos del 2 al 100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modulo7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Suponiendo que el número total de puntos de datos es 200, ahora podemos calcular el número total de k-mers en la distribución.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38672486</code></pre>
</div>
</div>
</section></section><section id="determinar-la-posición-del-pico-y-el-tamaño-del-genoma" class="level3"><h3 class="anchored" data-anchor-id="determinar-la-posición-del-pico-y-el-tamaño-del-genoma">4. Determinar la posición del pico y el tamaño del genoma</h3>
<p>A partir del gráfico trazado, podemos tener una idea de dónde se encuentra la posición del pico mas alto. Usando el siguiente comando, examinaremos los puntos de datos reales entre 40 y 80.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">40</span><span class="op">:</span><span class="fl">80</span>,<span class="op">]</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   V1    V2
40 40  3311
41 41  4286
42 42  5200
43 43  6492
44 44  7879
45 45  9416
46 46 11468
47 47 13292
48 48 15395
49 49 17354
50 50 18787
51 51 20985
52 52 22185
53 53 23885
54 54 24896
55 55 26102
56 56 27029
57 57 27132
58 58 26910
59 59 26107
60 60 25867
61 61 25011
62 62 23975
63 63 23021
64 64 21481
65 65 20266
66 66 18585
67 67 17185
68 68 15126
69 69 13399
70 70 12042
71 71 10694
72 72  9157
73 73  7988
74 74  7005
75 75  5772
76 76  4804
77 77  3868
78 78  3414
79 79  2795
80 80  2298</code></pre>
</div>
</div>
<p>En este caso, el pico está en el punto <strong>57</strong>. Por lo tanto, el tamaño del genoma se puede estimar como:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">as.numeric</span>(dataframe19[<span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">1</span>]<span class="sc">*</span>dataframe19[<span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>]))<span class="sc">/</span><span class="dv">57</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">678464.7</span> <span class="do">## ~ 678 Mb</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Sería interesante ver la proporción de la región de copia única en comparación con el tamaño total del genoma. En este conjunto de datos, la región de copia única se encuentra entre el punto de datos 2 y 100, por lo que el tamaño de la región de copia única se puede calcular aproximadamente como:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">as.numeric</span>(dataframe19[<span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">1</span>]<span class="sc">*</span>dataframe19[<span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">2</span>]))<span class="sc">/</span><span class="dv">57</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">653163.7</span> <span class="do">## ~ 653 Mb</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Revisar aqui el genoma de referencia <a href="https://www.ncbi.nlm.nih.gov/datasets/taxonomy/2098/">Aqui</a></p>
<p>La proporción se puede calcular como:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9627086</code></pre>
</div>
</div>
<section id="comparar-la-forma-del-pico-con-la-distribución-de-poisson" class="level4"><h4 class="anchored" data-anchor-id="comparar-la-forma-del-pico-con-la-distribución-de-poisson">5. Comparar la forma del pico con la distribución de Poisson</h4>
<p>Dado que tenemos una curva agradable, podemos comparar nuestra curva con una curva teórica, que es la distribución de Poisson.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">singleC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">200</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">57</span></span>
<span><span class="va">poisdtb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">57</span><span class="op">)</span><span class="op">*</span><span class="va">singleC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">poisdtb</span>, type<span class="op">=</span><span class="st">'l'</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">57</span><span class="op">]</span> <span class="op">*</span> <span class="va">singleC</span>, type <span class="op">=</span> <span class="st">"l"</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">dataframe19</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span>,type<span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modulo7_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section></section><section id="alineamiento" class="level2"><h2 class="anchored" data-anchor-id="alineamiento">Alineamiento</h2>
<section id="formato-sambam" class="level3"><h3 class="anchored" data-anchor-id="formato-sambam">Formato SAM/BAM</h3>
<p>El formato SAM (Sequence Alignment Map) y su versión binaria comprimida BAM (Binary Alignment Map) son herramientas cruciales en el análisis de datos de secuenciación de nueva generación (NGS). Estos formatos se utilizan para representar alineamientos de secuencias con el objetivo de mapear las letras (bases) de dos o más secuencias, permitiendo incluso la detección de espaciadores (indels) y otros tipos de variaciones. A continuación, se detalla el contenido y la importancia de estos formatos:</p>
<div class="callout callout-style-default callout-note callout-titled" title="Contenido del formato SAM">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Contenido del formato SAM
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>El formato SAM consta de dos partes principales: el encabezado (Header) y el cuerpo del alineamiento (Alignment). El encabezado contiene líneas que comienzan con “@” y proporciona información vital sobre el alineamiento, como la longitud de cada cromosoma, el programa utilizado para generar el alineamiento, entre otros detalles relevantes.</p>
<p>El cuerpo del alineamiento incluye una línea por cada alineamiento de secuencias. Cada línea contiene varias columnas que describen las características del alineamiento. Aquí se enumeran las columnas y su significado:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Read id: Identificador único de la lectura.</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>FLAG: Información sobre el alineamiento, como orientación, calidad, etc.</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Chr: Cromosoma al que se alinea la secuencia.</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Start: Posición de inicio en el cromosoma.</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Mapping quality: Calidad del mapeo.</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>CIGAR (alignment): Describe las operaciones de alineamiento, como inserciones, deleciones y sustituciones.</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>MateChr: Cromosoma del compañero de lectura (en el caso de lecturas pareadas).</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>MateStart: Posición de inicio del compañero de lectura.</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>MateDist: Distancia entre las lecturas pareadas.</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>QuerySeq: Secuencia de la lectura.</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>QueryBaseQuals: Calidad de las bases en la lectura.</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>AlignmentScore: Puntuación de alineamiento.</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>Edit-distance-to-reference: Distancia de edición con respecto a la secuencia de referencia.</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>Number-of-hits: Número de alineamientos similares.</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>Strand: Orientación de la lectura.</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>Hit-index: Índice del alineamiento.</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Ejemplo de un alineamiento en SAM:</p>
<p><strong>Alineamiento convecional</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Coor     12345678901234  5678901234567890123456789012345</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ref      AGCATGTTAGATAA**GATAGCTGTGCTAGTAGGCAGTCAGCGCCAT</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>+r001/1        TTAGATAAAGGATA*CTG</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>+r002         aaaAGATAA*GGATA</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>+r003       gcctaAGCTAA</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>+r004                     ATAGCT..............TCAGC</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>-r003                            ttagctTAGGC</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>-r001/2                                        CAGCGGCAT</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>En SAM se codifica así:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>@HD VN:1.5 SO:coordinate</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>@SQ SN:ref LN:45</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>r001   99 ref  7 30 8M2I4M1D3M = 37  39 TTAGATAAAGGATACTG *</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>r002    0 ref  9 30 3S6M1P1I4M *  0   0 AAAAGATAAGGATA    *</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>r003    0 ref  9 30 5S6M       *  0   0 GCCTAAGCTAA       * SA:Z:ref,29,-,6H5M,17,0;</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>r004    0 ref 16 30 6M14N5M    *  0   0 ATAGCTTCAGC       *</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>r003 2064 ref 29 17 6H5M       *  0   0 TAGGC             * SA:Z:ref,9,+,5S6M,30,1;</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>r001  147 ref 37 30 9M         =  7 -39 CAGCGGCAT         * NM:i:1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="preparacion-del-index" class="level3"><h3 class="anchored" data-anchor-id="preparacion-del-index">Preparacion del index</h3>
<p>Además de la representación de alineamientos, también es importante entender cómo se prepara el índice del genoma de referencia y cómo se realizan los alineamientos de secuencias. El índice se crea a partir del genoma de referencia y es esencial para realizar alineamientos eficientes. Aquí se presentan los comandos utilizados en el proceso:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">BASH</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">## creamos una carpeta para el indexado de genoma</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> index </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> index</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">## descarga de genoma de referencia</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://ftp.ncbi.nlm.nih.gov/genomes/refseq/bacteria/Metamycoplasma_hominis/latest_assembly_versions/GCF_000085865.1_ASM8586v1/GCF_000085865.1_ASM8586v1_genomic.fna.gz</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">## realizamos el indexado del genoma</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="ex">bwa</span> index <span class="at">-p</span> ref GCF_000085865.1_ASM8586v1_genomic.fna.gz</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Descargar genoma</span></span>
<span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/reference/ref.json"</span><span class="op">)</span></span>
<span><span class="va">filename</span> <span class="op">&lt;-</span> <span class="st">"GCF_000085865.1_ASM8586v1_genomic.fna.gz"</span></span>
<span><span class="fu">download_genome</span><span class="op">(</span><span class="va">url</span><span class="op">$</span><span class="va">urlref</span>, <span class="va">filename</span>, <span class="st">"data/reference/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Generar Indice</span></span>
<span><span class="fu">bowtie2_build</span><span class="op">(</span><span class="st">"data/reference/GCF_000085865.1_ASM8586v1_genomic.fna"</span>, </span>
<span>    bt2Index <span class="op">=</span> <span class="st">"data/reference/index/myco"</span> , overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Aclaracion">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aclaracion
</div>
</div>
<div class="callout-body-container callout-body">
<p>En esta sección se plantea la ejecución en paralelo de R y BASH. Despues ahondaremos en R.</p>
</div>
</div>
</section><section id="alineamiento-de-secuencias" class="level3"><h3 class="anchored" data-anchor-id="alineamiento-de-secuencias">Alineamiento de secuencias</h3>
<p>Estos comandos ilustran la descarga del genoma de referencia, la creación de un índice para el genoma y el proceso de alineamiento de secuencias utilizando la herramienta Bowtie2. Posteriormente, los alineamientos se convierten en formato BAM utilizando Samtools.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">BASH</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Alineamineto de genoma</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">bwa</span> mem <span class="at">-t</span> 4 <span class="at">-o</span> gen.sam reference/index/ref SRR15616380_1.fastq.gz SRR15616380_2.fastq.gz</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Creación de Archivo BAM</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> view <span class="at">-u@</span> 2 gen.sam <span class="kw">|</span> <span class="dt">\</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> sort <span class="at">-@</span> 2 <span class="at">-o</span> gen.sorted.bam <span class="at">-</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="ex">samtools</span> index gen.sorted.bam</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Alineamineto de genoma</span></span>
<span><span class="fu">bowtie2</span><span class="op">(</span>bt2Index <span class="op">=</span> <span class="st">"data/reference/index/myco"</span>, </span>
<span>        samOutput <span class="op">=</span> <span class="st">"results/SRR15616379.sam"</span>, </span>
<span>        seq1 <span class="op">=</span> <span class="st">"data/processed_data/filtered_F/SRR15616379_filt_1.fastq"</span>, </span>
<span>        seq2 <span class="op">=</span> <span class="st">"data/processed_data/filtered_R/SRR15616379_filt_2.fastq"</span>, </span>
<span>        <span class="st">"--threads=3"</span><span class="op">)</span></span>
<span>        </span>
<span><span class="co">## Creación de Archivo BAM</span></span>
<span><span class="fu">asBam</span><span class="op">(</span><span class="st">"results/SRR15616379.sam"</span><span class="op">)</span>       </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="En resumen">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
En resumen
</div>
</div>
<div class="callout-body-container callout-body">
<p>El formato SAM/BAM y los procesos de indexado y alineamiento son elementos esenciales en el análisis de datos de secuenciación de nueva generación (NGS), permitiendo la representación y procesamiento de alineamientos de secuencias de manera eficiente. Para obtener más información detallada sobre estos formatos y sus aplicaciones, se recomienda consultar la documentación oficial de Samtools y la especificación del formato SAM <a href="http://www.htslib.org/">aquí</a>.</p>
</div>
</div>


</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Volver arriba</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script><script src="https://utteranc.es/client.js" repo="FranciscoAscue/Rgenomics" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./modulo6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introducción a R</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./modulo8.html" class="pagination-link">
        <span class="nav-page-text">Genómica con R</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 © Copyright 2023 - Francisco Ascue Orosco
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>